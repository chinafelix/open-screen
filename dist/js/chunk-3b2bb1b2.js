(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b2bb1b2"],{"1f36":function(e,t,l){},3259:function(e,t,l){"use strict";var r=l("1f36"),a=l.n(r);a.a},8274:function(e,t,l){"use strict";l.r(t);var r=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"table"},[l("div",{staticClass:"crumbs"},[l("el-breadcrumb",{attrs:{separator:"/"}},[l("el-breadcrumb-item",[l("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 卡券列表")])],1)],1),l("div",{staticClass:"container"},[l("div",{staticClass:"handle-box"},[l("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选关键词"},model:{value:e.args.keyword,callback:function(t){e.$set(e.args,"keyword",t)},expression:"args.keyword"}}),l("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("搜索")]),l("el-button",{staticClass:"handle-del mr10",staticStyle:{float:"right"},attrs:{type:"success",icon:"add"},on:{click:e.handleAdd}},[e._v("添加")])],1),l("el-table",{staticClass:"table",attrs:{data:e.tableData,border:""}},[l("el-table-column",{attrs:{prop:"id",label:"ID",width:"200"}}),l("el-table-column",{attrs:{prop:"couponName",label:"卡券名称"}}),l("el-table-column",{attrs:{prop:"seller.sellerName",label:"商家"}}),l("el-table-column",{attrs:{prop:"couponAmount",label:"数量"}}),l("el-table-column",{attrs:{prop:"couponStock",label:"剩余数量"}}),l("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),l("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"warning",icon:"el-icon-edit",circle:""},on:{click:function(l){return e.handleEdit(t.row)}}}),l("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(l){return e.handleDelete(t.row)}}}),l("el-tooltip",{attrs:{effect:"dark",content:"启用或禁用",placement:"top"}},[l("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(l){return e.handleEnable(t.row.id,t.row.enable)}},model:{value:t.row.enable,callback:function(l){e.$set(t.row,"enable",l)},expression:"scope.row.enable"}})],1)]}}])})],1),l("div",{staticClass:"pagination"},[l("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.page.total,"page-size":e.args.pageSize},on:{"current-change":e.handlePager}})],1)],1),l("el-dialog",{attrs:{title:"编辑",visible:e.ctrl.editVisible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.ctrl,"editVisible",t)}}},[l("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"商品名称",prop:"couponName"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.couponName,callback:function(t){e.$set(e.form,"couponName",t)},expression:"form.couponName"}})],1),l("el-form-item",{attrs:{label:"副标题",prop:"couponTitle"}},[l("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入副标题"},model:{value:e.form.couponTitle,callback:function(t){e.$set(e.form,"couponTitle",t)},expression:"form.couponTitle"}})],1),l("el-form-item",{attrs:{label:"卡券分组",prop:"tagId"}},[l("el-radio-group",{model:{value:e.form.tagId,callback:function(t){e.$set(e.form,"tagId",t)},expression:"form.tagId"}},e._l(e.tags,(function(t){return l("el-radio",{key:t.id,attrs:{label:t.id}},[e._v("\n                                "+e._s(t.tagName)+"\n                              ")])})),1)],1),l("el-form-item",{attrs:{label:"卡券类型",prop:"typeId"}},[l("el-radio-group",{model:{value:e.form.typeId,callback:function(t){e.$set(e.form,"typeId",t)},expression:"form.typeId"}},e._l(e.types,(function(t){return l("el-radio",{key:t.id,attrs:{label:t.id}},[e._v("\n                            "+e._s(t.typeName)+"\n                          ")])})),1)],1),l("el-row",{attrs:{gutter:10}},[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"商家",prop:"sellerId"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.sellerId,callback:function(t){e.$set(e.form,"sellerId",t)},expression:"form.sellerId"}},e._l(e.sellers,(function(e){return l("el-option",{key:e.id,attrs:{label:e.sellerName,value:e.id}})})),1)],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"卡券数量",prop:"couponAmount"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.couponAmount,callback:function(t){e.$set(e.form,"couponAmount",t)},expression:"form.couponAmount"}})],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"剩余数量",prop:"couponStock"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.couponStock,callback:function(t){e.$set(e.form,"couponStock",t)},expression:"form.couponStock"}})],1)],1)],1),l("el-row",{attrs:{gutter:10}},[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"日期限制"}},[l("el-col",{attrs:{span:11}},[l("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.limitTimeStart,callback:function(t){e.limitTimeStart=t},expression:"limitTimeStart"}})],1),l("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),l("el-col",{attrs:{span:11}},[l("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.limitTimeEnd,callback:function(t){e.limitTimeEnd=t},expression:"limitTimeEnd"}})],1)],1)],1),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"区域限制"}},[l("el-cascader",{attrs:{options:e.regions,"change-on-select":!0,props:{label:"regionName",value:"id"},clearable:""},model:{value:e.limitRegion,callback:function(t){e.limitRegion=t},expression:"limitRegion"}})],1)],1)],1),l("el-form-item",{attrs:{label:"限制描述",prop:"limitRemark"}},[l("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入"},model:{value:e.form.limitRemark,callback:function(t){e.$set(e.form,"limitRemark",t)},expression:"form.limitRemark"}})],1),l("el-form-item",{attrs:{label:"排序",prop:"sort"}},[l("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),l("el-form-item",{attrs:{label:"描述",prop:"remark"}},[l("quill-editor",{ref:"quillEditor",attrs:{options:e.editorOption},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.ctrl.editVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确 定")])],1)],1)],1)},a=[],o=(l("28a5"),l("a753"),l("8096"),l("14e1"),l("953d")),i=l("23e6"),n={name:"sellerCoupon",data:function(){return{url:{data:"/manager/seller/coupon",create:"/manager/seller/coupon/create",update:"/manager/seller/coupon/update",remove:"/manager/seller/coupon/remove",sellers:"/manager/seller/all",types:"/manager/seller/coupon/type",tags:"/manager/seller/coupon/tags",regions:"/manager/sys/region/tree"},tableData:[],sellers:[],types:[],regions:[],tags:[],ctrl:{editVisible:!1,tagsVisible:!1,new:!1},page:{total:0},args:{sellerId:"",keyword:"",pageIndex:1,pageSize:10,count:!0},form:{id:"",typeId:"",tagId:"",couponName:"",couponTitle:"",couponAmount:"",couponStock:"",sellerId:"",limitTimeStart:"",limitTimeEnd:"",limitRegion:"",limitRegionId:"",limitRemark:"",sort:"",remark:""},editorOption:{placeholder:"请输入",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],[{align:[]}],["clean"]]}},rules:{typeId:[{required:!0,message:"不能为空",trigger:"blur"}],tagId:[{required:!0,message:"不能为空",trigger:"blur"}],couponName:[{required:!0,message:"不能为空",trigger:"blur"}],couponTitle:[{required:!0,message:"不能为空",trigger:"blur"}],sellerId:[{required:!0,message:"不能为空",trigger:"blur"}],sort:[{required:!0,message:"不能为空",trigger:"blur"},{validator:i["b"],trigger:"blur"}],couponStock:[{required:!0,message:"不能为空",trigger:"blur"},{validator:i["b"],trigger:"blur"}],couponAmount:[{required:!0,message:"不能为空",trigger:"blur"},{validator:i["b"],trigger:"blur"}]}}},created:function(){this.getData(!0),o["quillEditor"].mounted=function(){this.initialize(),this.quill.container.style.minHeight="230px"}},components:{quillEditor:o["quillEditor"]},computed:{limitRegion:{get:function(){return(this.form.limitRegionId||"").split("-")},set:function(e){this.form.limitRegionId=e.join("-");var t=[],l=this.regions;for(var r in e){var a=e[r];for(var o in l)if(l[o].id==a){t.push(l[o].regionName),l=l[o].children||[];break}}this.form.limitRegion=0==t.length?"不限":t.join("-")}},limitTimeStart:{get:function(){return this.form.limitTimeStart},set:function(e){this.form.limitTimeStart=e.Format("yyyy-MM-dd")}},limitTimeEnd:{get:function(){return this.form.limitTimeEnd},set:function(e){this.form.limitTimeEnd=e.Format("yyyy-MM-dd")}}},methods:{getData:function(e){var t=this;e&&(this.args.count=!0,this.args.pageIndex=1,this.$axios.get(this.url.types,{}).then((function(e){t.types=e.data||[]})),this.$axios.get(this.url.tags,{}).then((function(e){t.tags=e.data||[]})),this.$axios.post(this.url.sellers,{keyword:""}).then((function(e){t.sellers=e.data||[]})),this.$axios.post(this.url.regions,{}).then((function(e){t.regions=e.data||[]}))),this.$axios.post(this.url.data,this.args).then((function(l){t.tableData=l.data.list||[],e&&(t.page.total=l.data.total||0)}))},handlePager:function(e){this.args.pageIndex=e,this.getData(!1)},handleEdit:function(e){this.$exts.replaceObject(this.form,e),this.ctrl.new=!1,this.ctrl.editVisible=!0},handleSearch:function(){this.getData(!0)},handleAdd:function(){this.$exts.clearObject(this.form),this.ctrl.new=!0,this.ctrl.editVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确认删除？").then((function(){t.$axios.post(t.url.remove,{id:e.id}).then((function(e){t.$message.success("删除成功"),t.getData(!0)}))})).catch((function(){}))},handleEnable:function(e,t){var l=this;this.$axios.post(this.url.update,{id:e,enable:t}).then((function(e){l.$message.success("设置成功"),l.getData(!1)}))},handleSave:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.$axios.post(e.ctrl.new?e.url.create:e.url.update,e.form).then((function(t){e.$message.success(e.ctrl.new?"创建成功":"修改成功"),e.ctrl.editVisible=!1,e.getData(!0)}))}))}}},s=n,c=(l("3259"),l("2877")),u=Object(c["a"])(s,r,a,!1,null,"163c2e70",null);t["default"]=u.exports}}]);