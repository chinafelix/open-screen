(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24d5654b"],{"2db0":function(t,e,a){},"3fdb":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),t._v(" Banner设置")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-select",{attrs:{placeholder:"请选择渠道"},model:{value:t.args.channel,callback:function(e){t.$set(t.args,"channel",e)},expression:"args.channel"}},t._l(t.channels,(function(t){return a("el-option",{key:t.key,attrs:{value:t.key,label:t.value}})})),1),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:t.handleReset}},[t._v("重置")]),a("el-button",{staticClass:"handle-del mr10",staticStyle:{float:"right"},attrs:{type:"primary",icon:"delete"},on:{click:t.handleAdd}},[t._v("添加")])],1),a("el-table",{staticClass:"table",attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"200"}}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{label:"图标"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.pic,"min-width":"70",height:"70"}})]}}])}),a("el-table-column",{attrs:{prop:"url",label:"跳转"}}),a("el-table-column",{attrs:{prop:"sort",label:"排序"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",formatter:t.formatTime}}),a("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"el-button el-button--primary is-circle",attrs:{type:"button"},on:{click:function(a){return t.handleEdit(e.row)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{staticClass:"el-button el-button--danger is-circle",attrs:{type:"button"},on:{click:function(a){return t.handleDelete(e.row)}}},[a("i",{staticClass:"el-icon-delete"})]),a("el-tooltip",{attrs:{effect:"dark",content:"启用或禁用",placement:"top"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return t.handleEnable(e.row.id,e.row.status)}},model:{value:1==e.row.status,callback:function(a){t.$set(e.row,"status == 1",a)},expression:"scope.row.status == 1"}})],1)]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.page.total,"page-size":t.args.pageSize},on:{"current-change":t.handlePager}})],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.ctrl.editVisible,width:"40%"},on:{"update:visible":function(e){return t.$set(t.ctrl,"editVisible",e)}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:1===t.form.status},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"图片",prop:"pic"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:1===t.form.status,"show-file-list":!1,action:t._cfg.upload.url,data:{group:"seller-banner"},accept:t._cfg.upload.accept,"on-success":t.handleSuccessFile,"before-upload":t.handleBeforeFile}},[t.form.pic?a("img",{staticClass:"avatar",attrs:{src:t.form.pic}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{attrs:{disabled:1===t.form.status},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{label:"功能分类",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择功能分类",disabled:1===t.form.status},on:{change:t.changeFunctions},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.funcLists,(function(t){return a("el-option",{key:t.key,attrs:{value:t.key,label:t.field}})})),1)],1),2===t.form.type?a("el-form-item",{attrs:{label:"联合会员页的ID",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择页面",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.packages,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1):t._e(),11===t.form.type?a("el-form-item",{attrs:{label:"外部小程序ID",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择外部小程序",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.miniPrograms,(function(t){return a("el-option",{key:t,attrs:{value:t,label:t}})})),1),a("el-input",{class:{"input-active":t.urlEmpty},staticStyle:{"margin-top":"10px"},attrs:{placeholder:"请输入",disabled:1===t.form.status},on:{input:t.urlChange},model:{value:t.form.url,callback:function(e){t.$set(t.form,"url",e)},expression:"form.url"}}),t.urlEmpty?a("p",{staticClass:"tips"},[t._v("不能为空")]):t._e()],1):t._e(),3===t.form.type?a("el-form-item",{attrs:{label:"咖豆商品",prop:"subId"}},[a("el-select",{attrs:{disabled:1===t.form.status,filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":t.remoteMethod,loading:t.loading},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.products,(function(t){return a("el-option",{key:t.productId,attrs:{value:t.productId,label:t.productName}})})),1)],1):t._e(),4===t.form.type?a("el-form-item",{attrs:{label:"咖豆商城类目",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择咖豆商城类目",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.tags,(function(t){return a("el-option",{key:t.categoryId,attrs:{value:t.categoryId,label:t.categoryName}})})),1)],1):t._e(),10===t.form.type?a("el-form-item",{attrs:{label:"会员权益",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择会员权益",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.members,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.title}})})),1)],1):t._e(),9===t.form.type?a("el-form-item",{attrs:{label:"咖豆好礼",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择咖豆好礼",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.priviles,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.title}})})),1)],1):t._e(),5===t.form.type?a("el-form-item",{attrs:{label:"预售活动",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择咖豆好礼",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.actions,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1):t._e(),6===t.form.type?a("el-form-item",{attrs:{label:"领取好礼活动",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择领取好礼活动",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.gifts,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1):t._e(),7===t.form.type?a("el-form-item",{attrs:{label:"油耗活动",prop:"subId"}},[a("el-select",{attrs:{placeholder:"请选择油耗活动",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}},t._l(t.oils,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1):t._e(),8===t.form.type?a("el-form-item",{attrs:{label:"h5地址",prop:"subId"}},[a("el-input",{attrs:{placeholder:"请输入",disabled:1===t.form.status},model:{value:t.form.subId,callback:function(e){t.$set(t.form,"subId",e)},expression:"form.subId"}})],1):t._e(),a("el-form-item",{attrs:{label:"渠道",prop:"channel"}},[a("el-select",{attrs:{disabled:1===t.form.status},model:{value:t.form.channel,callback:function(e){t.$set(t.form,"channel",e)},expression:"form.channel"}},t._l(t.channels,(function(t){return a("el-option",{key:t.key,attrs:{value:t.key,label:t.value}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[1===t.form.status?a("el-button",{on:{click:function(e){t.ctrl.editVisible=!1}}},[t._v("确 定")]):t._e(),1!==t.form.status?a("el-button",{on:{click:function(e){t.ctrl.editVisible=!1}}},[t._v("取 消")]):t._e(),1!==t.form.status?a("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")]):t._e()],1)],1)],1)},r=[],i=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("a481"),a("bd86"));a("55dd");function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var o={name:"settingBanner",data:function(){return{urlEmpty:!1,service:"",url:{data:"/admin/banner/list",update:"/admin/banner/save",remove:"/admin/banner/remove",types:"/admin/banner/types",channels:"/admin/banner/channels",funcList:"admin-member/ecarxclub/banner/types",union:"admin-member/vipMember/packageCollections",tags:"/admin/product/category/list",privileges:"admin-member/ecarxclub/privileges",oil:"activity/admin/activities",product:"/admin/product/search"},ctrl:{editVisible:!1,new:!1},page:{total:0},args:{channel:"",pageNum:1,pageSize:10,count:!0},tableData:[],form:{id:"",title:"",pic:"",status:"",sort:"",type:"",channel:"",prop:[],subId:"",url:""},rules:{title:[{required:!0,message:"不能为空",trigger:"blur"},{min:1,max:20,message:"长度在20个字符以内",trigger:"blur"}],pic:[{required:!0,message:"不能为空",trigger:"blur"}],sort:[{required:!0,message:"不能为空",trigger:"blur"}],type:[{required:!0,message:"不能为空",trigger:"blur"}],channel:[{required:!0,message:"不能为空",trigger:"blur"}],subId:[{required:!0,message:"不能为空",trigger:"blur"}]},packages:[],miniPrograms:[],tags:[],members:[],priviles:[],actions:[],gifts:[],oils:[],products:[],funcLists:[],channels:[],loading:!1}},created:function(){var t=window.config&&window.config.x_env_api;this.service=t||"//api.xchanger.cn/",this.getData(!0),this.getMiniprogramIds(),this.getFuncList(),this.getChannelList(),this.getUnionPackages(),this.getProductList(),this.getTagList(),this.getActivites("order"),this.getActivites("flow"),this.getOilsList(),this.getMembersList(),this.getPrivileList()},methods:{urlChange:function(t){this.urlEmpty=!t},handleReset:function(){this.args={channel:"",pageNum:1,pageSize:10,count:!0},this.getData(!0)},getData:function(t){var e=this;this.$axios.get(this.url.data,{params:this.args}).then((function(a){if(!a.data)return e.tableData=[],e.page.total=0,!1;e.tableData=a.data.rows||[],t&&(e.page.total=a.data.total||0)}))},handlePager:function(t){this.args.pageNum=t,this.getData(!1)},handleSearch:function(){this.getData(!0)},handleEdit:function(t){this.$exts.replaceObject(this.form,t),this.ctrl.new=!1,this.ctrl.editVisible=!0,this.form.prop.length>0&&(this.form.subId=this.form.prop[0].value,2===this.form.prop.length&&(this.form.url=this.form.prop[1].value))},handleAdd:function(){this.$exts.clearObject(this.form),this.ctrl.new=!0,this.ctrl.editVisible=!0},handleDelete:function(t){var e=this;this.$confirm("确认删除？").then((function(){e.$axios.post("".concat(e.url.remove,"?fileId=").concat(t.id)).then((function(t){e.$message.success("删除成功"),e.getData(!0)}))})).catch((function(){}))},handleEnable:function(t,e){var a,s=this;a=1==e?0:1,this.$axios.post(this.url.update,{id:t,status:a}).then((function(t){s.$message.success("设置成功"),s.getData(!1)}))},handleBeforeFile:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传头像图片大小不能超过 2MB!"),e},handleSuccessFile:function(t,e){this.form.pic="//".concat(t.data.url)},handleSave:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;var a=t.form,s=a.id,r=a.pic,i=a.sort,l=a.title,n=a.type,o=a.channel,c=a.subId,u=a.url,d=t.funcLists,f=[];if(11==n&&!u)return t.urlEmpty=!0,!1;if(1===n)f=null;else if(d.length){for(var p=0;p<d.length;p++)if(n===d[p].key){if(c){var m=d[p].value[0].value;f.push({key:m,value:c})}if(u){var b=d[p].value[1].value;f.push({key:b,value:u})}}}else f=null;var h={id:s,pic:r,sort:i,title:l,type:n,channel:o,prop:f};t.$axios.post(t.url.update,h).then((function(e){t.$message.success(t.ctrl.new?"创建成功":"修改成功"),t.ctrl.editVisible=!1,t.getData(!0)}))}))},getMiniprogramIds:function(){var t=this;this.$axios.get("".concat(this.service).concat(this.url.funcList)).then((function(e){for(var a in e.types)"mini_program"===e.types[a].code&&(t.miniPrograms=e.types[a].appid||[])}))},getFuncList:function(){var t=this;this.$axios.get("".concat(this.url.types)).then((function(e){t.funcLists=e.data}))},getChannelList:function(){var t=this;this.$axios.get("".concat(this.url.channels)).then((function(e){t.channels=e.data}))},getUnionPackages:function(){var t=this,e={type:"union",status:"Y"};this.$axios.get("".concat(this.service).concat(this.url.union),{params:n({},e)}).then((function(e){t.packages=e.dataList||[]}))},getTagList:function(){var t=this,e={};this.$axios.get(this.url.tags,{params:n({},e)}).then((function(e){t.tags=e.data.rows||[]}))},getPrivileList:function(){var t=this,e={pageSize:1e3,privilegeType:"grow",effectiveStatus:"P,Y"};this.$axios.get(this.service+this.url.privileges,{params:n({},e)}).then((function(e){for(var a=0;a<e.length;a++)e[a].id=String(e[a].id);t.members=e.dataList||[]}))},getMembersList:function(){var t=this,e={pageSize:1e3,privilegeType:"integral",effectiveStatus:"P,Y"};this.$axios.get(this.service+this.url.privileges,{params:n({},e)}).then((function(e){for(var a=0;a<e.length;a++)e[a].id=String(e[a].id);t.priviles=e.dataList||[]}))},getOilsList:function(){var t=this,e={pageSize:1e3,type:"reward",status:1};this.$axios.get(this.service+this.url.oil,{params:n({},e)}).then((function(e){for(var a=0;a<e.length;a++)e[a].id=String(e[a].id);t.oils=e||[]}))},getActivites:function(t){var e=this,a={pageSize:1e3,type:t,status:1};this.$axios.get(this.service+this.url.oil,{params:n({},a)}).then((function(a){for(var s=0;s<a.length;s++)a[s].id=String(a[s].id);"flow"===t?e.gifts=a||[]:e.actions=a||[]}))},getProductList:function(t){var e=this,a={};t&&(a=t),this.$axios.get(this.url.product,{params:a}).then((function(t){e.loading=!1,e.products=t.data.rows||[]}))},changeFunctions:function(t){switch(t){case 2:this.getUnionPackages();break;case 3:this.getProductList();break;case 4:this.getTagList();break;case 5:this.getActivites("order");break;case 6:this.getActivites("flow");break;case 7:this.getOilsList();break;case 10:this.getMembersList();break;case 9:this.getPrivileList();break;default:return!1}},remoteMethod:function(t){this.loading=!0;var e={keyword:t};this.getProductList(e)},formatTime:function(t,e){return t.createTime.replace(/T/," ").substr(0,19)}}},c=o,u=(a("a7ce"),a("a00a"),a("2877")),d=Object(u["a"])(c,s,r,!1,null,"633f3bd2",null);e["default"]=d.exports},a00a:function(t,e,a){"use strict";var s=a("2db0"),r=a.n(s);r.a},a7ce:function(t,e,a){"use strict";var s=a("c329"),r=a.n(s);r.a},bd86:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("85f2"),r=a.n(s);function i(t,e,a){return e in t?r()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},c329:function(t,e,a){}}]);